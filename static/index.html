<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoGuard | Anomaly Detection</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="background-mesh"></div>
    <div class="scan-line"></div>

    <header>
        <div class="logo">
            <span class="icon">◈</span> CRYPTO<span class="highlight">GUARD</span>
        </div>
        <nav>
            <div class="status-indicator">SYSTEM ONLINE</div>
        </nav>
    </header>

    <main>
        <!-- HERO SECTION: Step 1 (Upload) -->
        <section id="upload-section" class="hero-container">
            <h1>Fraud <span class="gradient-text">Detection</span> Protocol</h1>
            <p class="subtitle">Upload transaction datasets to initialize XGBoost Anomaly Analysis.</p>

            <div class="upload-zone" id="drop-zone">
                <input type="file" id="fileInput" accept=".csv" hidden>
                <div class="upload-content">
                    <div class="upload-icon">⭳</div>
                    <h3>Drag & Drop CSV File</h3>
                    <p>or <span class="clickable" onclick="document.getElementById('fileInput').click()">browse
                            workstation</span></p>
                </div>
            </div>

            <div id="error-message" class="error-box hidden"></div>
        </section>

        <!-- CONFIG SECTION: Removed for Auto-Detection -->
        <!-- <section id="config-section" class="hero-container hidden"> ... </section> -->

        <!-- LOADING SECTION -->
        <div id="loader" class="loader hidden">
            <div class="scanner"></div>
            <p>TRAINING XGBOOST MODEL...</p>
        </div>

        <!-- DASHBOARD SECTION: Step 3 (Results) -->
        <section id="dashboard" class="dashboard-container hidden">

            <div class="dashboard-header">
                <h2>Analysis Report: <span id="filename-display" class="mono">data.csv</span></h2>
                <button class="btn-reset" onclick="location.reload()">NEW ANALYSIS</button>
            </div>

            <div class="metrics-grid">
                <div class="card metric-card">
                    <h3>Model Accuracy</h3>
                    <div class="value" id="accuracy-val">--%</div>
                    <div class="progress-bar">
                        <div class="fill" id="accuracy-bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="card metric-card">
                    <h3>ROC-AUC Score</h3>
                    <div class="value" id="auc-val">--</div>
                    <div class="progress-bar">
                        <div class="fill" id="auc-bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="card metric-card">
                    <h3>Precision</h3>
                    <div class="value" id="precision-val">--</div>
                </div>
                <div class="card metric-card">
                    <h3>Recall</h3>
                    <div class="value" id="recall-val">--</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="card chart-card">
                    <h3>
                        Feature Importance
                        <span class="info-icon"
                            data-tooltip="Shows which factors (columns) had the biggest impact on the model's decision to flag a transaction as fraud.">?</span>
                    </h3>
                    <canvas id="featureChart"></canvas>
                </div>

                <div class="card chart-card">
                    <h3>
                        Fraud Distribution (Amount)
                        <span class="info-icon"
                            data-tooltip="Visualizes the total stolen amount by Entity. Each color represents a specific Account or User ID. The largest slice shows the biggest fraudster.">?</span>
                    </h3>
                    <canvas id="pieChart"></canvas>
                </div>

                <div class="card chart-card full-width">
                    <h3>
                        Confusion Matrix
                        <span class="info-icon"
                            data-tooltip="A performance table: True Positives (correctly caught fraud) vs False Positives (false alarms). Helps measure reliability.">?</span>
                    </h3>
                    <div class="confusion-grid" id="confusion-matrix-display"></div>
                </div>
            </div>

            <div class="card table-card">
                <h3>⚠ High-Risk Anomalies Detected</h3>
                <div class="table-wrapper">
                    <table id="anomalies-table">
                        <thead>
                            <tr id="table-header"></tr>
                        </thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>
            </div>

        </section>
    </main>

    <script src="app.js"></script>
</body>

</html>